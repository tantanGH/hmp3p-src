mail 96/02/21 07:03 VDTPACKのバグ？
  1228bytes 189:たにぃ@PCM8PP.ｫ.jp 


	えーと、自称高速展開ルーチンでちょっとおかしな動作をしてたので、
	色々探って見たところ、最後がきちんと止まらないと言う現象があり、
	なんでかな〜といって何げに圧縮ソースを覗いていたら、ここがおか
	しいのでは？って所を発見しました。

	以下にそれを示します。

vpk.c
} else {	/* この時点で最終pixelだった場合 */
	if ( ph < 0 ) {
＞		if ( mode == 0 )
＞			*p++ = 13 << 4;
＞		*p++ = c>>8;		/* カラーコードを直接埋め込む */
＞		*p++ = c&0xff;
	} else {
		if ( mode == 1 )	/* これまで color mode だったなら */
			*(p-1) = *(p-1) | 1;	/* 輝度ビットのフラグを立てておく */
		*p++ = ph << 4 | 14;		/* 詰め物を入れる */
	}
	break;
}

	＞　の所何ですが、ここで終了の筈なのに、カラーコードに輝度ビット
	が立っていないのと、終了コードが無いと言うことに気が付きました。

	多分こうするだけだと思うのですが、

＞		if ( mode == 0 )
＞			*p++ = 13 << 4;
＞		*p++ = c>>8;		/* カラーコードを直接埋め込む */
ﾍﾝｺｳ＞		*p++ = ( c & 0xff ) | 1;
ﾂｲｶ＞		*p++ = 15 << 4;		/* 終了コードを埋めておく */

	どうなのでしょうか？

	展開ルーチンではサイズを見ていたみたいなので、これが無くても良い
	様になっていましたが、仕様とちょっと違うので･･･。ﾀﾞﾏｻﾚ･･･(ｫ

	って、全然見当はずれだったら済みません。

								たにぃ


削除しちゃいますか？ (y/n):Y

